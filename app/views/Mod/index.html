#{extends 'main_1.html' /}
<link rel="stylesheet" href="@{'/public/stylesheets/cart.css'}">
#{script src:"simpleCart.js" /}
<script> 

$(document).ready(function(){ 

    $(".fr").click(function(){ 

        var menID =  $(this).attr("id");
        
        var thisTop = $("#img_" + menID).offset().top; //所在位置的高度

        var thisLeft = $("#img_" + menID).offset().left; //所在位置的宽度

         animatenTop(thisTop,thisLeft);

        return false; 

    }); 
    


}); 

function showcart(){
	
	$("#cartPopover").show(); $("header .cartInfo").addClass('open');
}

function animatenTop(thisTop,thisLeft) {

    var CopyDiv = '<img src="images/490-260.png" id="box" style="top:' + thisTop + 'px;left:' + thisLeft + 'px" />';

    var topLength =  $(".cartInfo ").offset().top; //取得到购物车的宽度

    var leftLength = $(".cartInfo ").offset().left; //取得到购物车的宽度 

    $("body").append(CopyDiv);

    $("body").children("#box").animate({width: "30px",height: "30px","top": topLength, "left": leftLength, "opacity": .1  }, 900, function(){$(this).remove()});

}


</script>
<script>


$(function(){
	//encode html entities
	function htmlDecode(value) {
	    if (value) {
	        return $('<div />').text(value).html();
	    } else {
	        return '';
	    }
	}
	
	$('pre.html,pre.feature-html').each(function(){
		$(this).html(htmlDecode($(this).html()));
	});
	
	$("#demo .simpleCart_shelfItem").mouseenter(function(event) {
		$(this).find('.tooltip').fadeIn(200);
	});
	$("#demo .simpleCart_shelfItem").mouseleave(function(event) {
		$(this).find('.tooltip').fadeOut(200);
	});
	$(".cartInfo").toggle(function(){

		$("#cartPopover").show();
		$("header .cartInfo").addClass('open');
	}, function(){
		$("#cartPopover").hide();
		$("header .cartInfo").removeClass('open');
	});
	

});



simpleCart.currency({
	  code: "RMB" ,
	  symbol: "￥" ,
	  name: "人民币"
	});



simpleCart({
	//Setting the Cart Columns for the sidebar cart display.
	cartColumns: [
	//A custom cart column for putting the quantity and increment and decrement items in one div for easier styling.
	{ view: function(item, column){
		return "<span>"+item.get('quantity')+"</span>" +
		"<div>" +
		"<a href='javascript:;' class='simpleCart_increment'><img src='@{'/public/images/increment.png'}' title='+1' alt='arrow up'/></a>" +
		"<a href='javascript:;' class='simpleCart_decrement'><img src='@{'/public/images/decrement.png'}' title='-1' alt='arrow down'/></a>" +
		"</div>";
	}, attr: 'custom' },
		//Name of the item
	{ attr: "name" , label: false },
		//Subtotal of that row (quantity of that item * the price)
	{ view: 'currency', attr: "total" , label: false }
	],
	
	 checkout: {
		 type: "SendForm" ,
		 url: "https://mapi.alipay.com/gateway.do?_input_charset=utf-8"
		 },
	cartStyle: 'div'
});
</script>



<div class="shoppingBox ">
	<div class="cartInfo">
	<span    class="simpleCart_quantity"></span> 订单
	</div>
	
	
	<div id="cartPopover" style="display: none;">
			
			<div class="simpleCart_items">
				<div>
				<div>
					<div class="headerRow">
						<div class="item-custom"></div>
						<div class="item-name"></div>
						<div class="item-total"></div>
					</div>
				</div>

				</div>
			</div>
			<div id="cartData" class="clearfix">
			<div class="left">
				<strong>数量: </strong>
					<span class="simpleCart_quantity"></span>
			</div>
			<div class="right">
				<strong>餐费: </strong>
				<span class="simpleCart_total"></span>
			</div>
			<div id="popoverButtons" class="clearfix">
				<a class="hudbtn primary right" href="/cart">查看订单</a>
				
			</div>
			<a class="simpleCart_empty" href="javascript:;">清空</a>
			
			</div>
		</div>
	
</div>




<a name="taocan"></a>
<div class="wrap jinritaocan">
<h2>套餐</h2>
<ul>

#{list combos, as:'combo'}

<li>
<a href="#"><img src="${combo.url}" id="img_combo${combo.id}" /></a>
<div class="des">
<p class="fl"><strong>${combo.name} </strong>&nbsp;&nbsp;${combo.des} </p>
<span class="fl">&yen;<em>${combo.price.price}</em></span>
<a class="fr" href="javascript:;"  id='combo${combo.id}'  onclick="showcart();simpleCart.add({name:'${combo.name}', price: ${combo.price.price},size:'tiny',thumb:'e.png'});">立即订购</a>
</div>
</li>
 #{/list}





</ul>
</div>
<div class="clear"></div>








<a name="dandian"></a>
<div class="wrap zhushi others">
<h2>主食</h2>
<ul>
#{list mainmeals, as:'meal'}
<li>
<a href="#"><img src="images/240-240.png" id="img_${meal.id}" /></a>
<p><a class="fr" href="javascript:;" id='${meal.id}'   onclick="showcart();simpleCart.add({name:'${meal.name}', price: ${meal.price.price},size:'tiny',thumb:'e.png'});">立即订购</a>
<span><em>&yen;</em>${meal.price.price}</span><br />
【${meal.name}】
</p>
</li> 

 #{/list}


</ul>
</div>
<div class="clear"></div>





<div class="wrap tanglei others">
<h2>汤类</h2>
<ul>
#{list tangmeals, as:'meal'}
<li>
<a href="#"><img src="images/240-240.png" id="img_${meal.id}" /></a>
<p><a class="fr" href="javascript:;" id='${meal.id}'   onclick="showcart();simpleCart.add({name:'${meal.name}', price: ${meal.price.price},size:'tiny',thumb:'e.png'});">立即订购</a>
<span><em>&yen;</em>${meal.price.price}</span><br />
【${meal.name}】
</p>
</li> 

 #{/list}

</ul>
</div>
<div class="clear"></div>


</body>
</html>
